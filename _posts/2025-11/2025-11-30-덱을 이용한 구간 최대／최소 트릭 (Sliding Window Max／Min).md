---
title: "[알고리즘] 덱을 이용한 구간 최대／최소 트릭 (Sliding Window Max／Min)"
date: 2025-11-30
categories: [Algorithm, Two Pointers & Sliding Window]
tags: [슬라이딩 윈도우, 덱, 덱을 이용한 구간 최대/최소 트릭]
toc: true
math: true
image: /assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/thumbnail.drawio.svg
---

## 1. 덱을 이용한 구간 최대／최소 트릭

주어진 구간의 최댓값 또는 최솟값을 구해야 하는 상황을 가정해보자.

$N$ 개의 수 $A_1$, $A_2$, ..., $A_N$ 이 주어지고 자연수 $L$ 이 주어졌을 때, 구간 $A_{i-L+1}$ ~ $A_i$ 의 최솟값 또는 최댓값을 구해야 한다. 몇 번만 구해야 한다면 간단하게 해결할 수 있지만 모든 $i$ 에 대해 최대/최소를 구해야 할 경우 $O(N \times L)$ 만큼의 시간이 걸릴 것이다. 이때 단조 덱을 활용하면 $O(N)$ 으로 이 문제를 해결할 수 있다.

주어진 수열이 $$\{1, 5, 2, 3, 6, 2, 3, 7, 3, 5, 2, 6\}$$ 이고 $L$ 이 $3$ 이며 모든 $i$ 에 대한 구간 $A_{i-L+1}$ ~ $A_i$ 의 최솟값을 구하는 경우 정답은 $$\{1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 2, 2\}$$ 이 된다. 이는 아래 표를 통해 확인할 수 있다.

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo01.drawio.svg>)

슬라이딩 윈도우를 활용하면 될 것 같은데 윈도우 내 구간의 최솟값을 알 수 있으면서 윈도우에서 빠져나가는 수를 어떻게 찾을 수 있을까? 단조 덱을 활용하면 이 문제를 깔끔하게 해결할 수 있다.

단조 덱은 덱 내의 원소들이 선형 증가 또는 선형 감소하는 덱으로 윈도우의 정보를 단조 덱으로 관리한다면 단조 덱의 맨 앞 원소를 통해 최솟값을 알아 낼 수 있다. 그렇다면 이제 단조 덱을 적절하게 갱신하는 방법을 알아야 한다. 갱신은 단조 덱에 윈도우의 이동으로 빠지는 값과 추가되는 값을 적절하게 처리해줘야 한다.

먼저 단조 덱은 수열의 인덱스 정보를 저장한다. 인덱스가 커지는 방향으로 윈도우가 이동하므로 덱의 뒤에만 삽입을 한다면 이 덱은 단조 덱이 된다. 삽입은 새로 삽입하는 수가 단조 덱의 맨 뒤 원소보다 작거나 같다면 단조 덱의 맨 뒤 원소를 삭제하는 과정을 반복한다. 새로 삽입하는 수보다 크거나 같은 수는 윈도우 내 최솟값이 될 수 없으므로 필요없는 정보다. 삭제는 단조 덱의 맨 앞 원소가 구간을 벗어났는지 체크해서 벗어나면 단조 덱에서 제거하면 된다. 단조 덱이 인덱스를 가지고 있으므로 벗어났는지 여부는 간단하게 체크할 수 있다. 마지막으로 최솟값 조회는 단조 덱의 맨 앞 원소를 통해 얻은 인덱스 정보로 수열에서 조회해서 얻을 수 있다. 삽입, 삭제 과정으로 윈도우 내 정보만 단조 덱에 존재하므로 맨 앞 원소가 윈도우 내 최솟값의 인덱스를 가리킨다. 이 과정은 아래와 같이 진행된다.

---

## 2. 덱을 이용한 구간 최대／최소 트릭 진행 과정

아까와 동일한 수열일 때, $A_1$ 의 인덱스는 $0$, 값은 $1$ 이다. 구간은 $A_{-1}$ ~ $A_1$ 인데 구간을 벗어나는 경우는 무시한다고 하자. 그러면 실제 구간은 $A_1$ ~ $A_1$ 이 된다.

단조 덱이 비어있으므로 삭제는 일어나지 않고, 단조 덱이 비어있으므로 $1$ 보다 작거나 같은 원소가 없어 단조 덱에 인덱스를 삽입한다. 단조 덱의 맨 앞 원소를 통해 얻은 인덱스로 수열에서 조회하면 구간 $A_1$ ~ $A_1$ 의 최솟값은 $1$ 이 된다.

수열

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo02.drawio.svg>)

단조 덱 (인덱스 $0$ 삽입)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo03.drawio.svg>)

$A_2$ 의 인덱스는 $1$, 값은 $5$ 이다. 구간은 $A_0$ ~ $A_2$ 인데 구간을 벗어나는 경우는 무시한다고 하자. 그러면 실제 구간은 $A_1$ ~ $A_2$ 이 된다.

단조 덱이 비어있지 않으므로 단조 덱의 맨 앞 원소가 구간을 벗어났는지 검사한다. 현재 벗어나지 않았다. 단조 덱이 비어있지 않으므로 단조 덱의 맨 뒤 원소부터 현재 값보다 작거나 같으면 단조 덱에서 제거하자. 현재 인덱스 $0$ 의 값인 $1$ 이 더 작으므로 제거하지 않고 이후 새로 추가된 인덱스를 삽입한다. 단조 덱의 맨 앞 원소를 통해 얻은 인덱스로 수열에서 조회하면 구간 $A_1$ ~ $A_2$ 의 최솟값은 $1$ 이 된다.

수열

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo04.drawio.svg>)

단조 덱 (인덱스 $0$ 은 구간을 벗어나지 않음)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo05.drawio.svg>)

단조 덱 (인덱스 $0$ 의 값 $1$ 이 인덱스 $1$ 의 값 $5$ 보다 작아서 삭제하지 않음)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo06.drawio.svg>)

단조 덱 (인덱스 $1$ 삽입)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo07.drawio.svg>)

$A_3$ 의 인덱스는 $2$, 값은 $2$ 이다. 구간은 $A_1$ ~ $A_3$ 이 된다.

단조 덱이 비어있지 않으므로 단조 덱의 맨 앞 원소가 구간을 벗어났는지 검사한다. 현재 벗어나지 않았다. 단조 덱이 비어있지 않으므로 단조 덱의 맨 뒤 원소부터 현재 값보다 작거나 같으면 단조 덱에서 제거하자. 현재 인덱스 $1$ 의 값인 $5$ 가 더 크므로 제거한다. 다음 원소인 $0$ 의 값은 $1$ 이며 이는 새로 추가하는 값보다 작으므로 삭제하지 않고 이후 새로 추가된 인덱스를 삽입한다. 단조 덱의 맨 앞 원소를 통해 얻은 인덱스로 수열에서 조회하면 구간 $A_1$ ~ $A_3$ 의 최솟값은 $1$ 이 된다.

수열

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo08.drawio.svg>)

단조 덱 (인덱스 $0$ 은 구간을 벗어나지 않음)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo09.drawio.svg>)

단조 덱 (인덱스 $1$ 의 값 $5$ 가 인덱스 $2$ 의 값 $2$ 보다 크므로 삭제)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo10.drawio.svg>)

단조 덱 (인덱스 $0$ 의 값 $1$ 이 인덱스 $2$ 의 값 $2$ 보다 작아서 삭제하지 않음)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo11.drawio.svg>)

단조 덱 (인덱스 $2$ 삽입)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo12.drawio.svg>)

$A_4$ 의 인덱스는 $3$, 값은 $3$ 이다. 구간은 $A_2$ ~ $A_4$ 가 된다.

단조 덱이 비어있지 않으므로 단조 덱의 맨 앞 원소가 구간을 벗어났는지 검사한다. 현재 벗어났으므로 단조 덱에서 제거한다. 단조 덱이 비어있지 않으므로 단조 덱의 맨 뒤 원소부터 현재 값보다 작거나 같으면 단조 덱에서 제거하자. 현재 인덱스 $2$ 의 값인 $2$ 가 더 작으므로 제거하지 않고 이후 새로 추가된 인덱스를 삽입한다. 단조 덱의 맨 앞 원소를 통해 얻은 인덱스로 수열에서 조회하면 구간 $A_2$ ~ $A_4$ 의 최솟값은 $2$ 가 된다.

수열

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo13.drawio.svg>)

단조 덱 (인덱스 $0$ 은 구간을 벗어났으므로 삭제)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo14.drawio.svg>)

단조 덱 (인덱스 $2$ 의 값 $2$ 가 인덱스 $3$ 의 값 $3$ 보다 작아서 삭제하지 않음)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo15.drawio.svg>)

단조 덱 (인덱스 $3$ 삽입)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo16.drawio.svg>)

마찬가지로 $A_5$ 에 대해서는 아래와 같이 되고 구간은 $A_3$ ~ $A_5$ 의 최솟값은 $2$ 가 된다.

수열

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo17.drawio.svg>)

단조 덱 (인덱스 $4$ 삽입)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo18.drawio.svg>)

$A_6$ 의 인덱스는 $5$, 값은 $2$ 이다. 구간은 $A_4$ ~ $A_6$ 이 된다.

단조 덱이 비어있지 않으므로 단조 덱의 맨 앞 원소가 구간을 벗어났는지 검사한다. 현재 벗어났으므로 단조 덱에서 제거한다. 단조 덱이 비어있지 않으므로 단조 덱의 맨 뒤 원소부터 현재 값보다 작거나 같으면 단조 덱에서 제거하자. 현재 인덱스 $2$ 의 값인 $2$ 가 더 작으므로 제거하지 않고 이후 새로 추가된 인덱스를 삽입한다. 단조 덱의 맨 앞 원소를 통해 얻은 인덱스로 수열에서 조회하면 구간 $A_2$ ~ $A_4$ 의 최솟값은 $2$ 가 된다.

수열

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo19.drawio.svg>)

단조 덱 (인덱스 $2$는 구간을 벗어났으므로 삭제)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo20.drawio.svg>)

단조 덱 (인덱스 $4$ 의 값 $6$ 이 인덱스 $5$ 의 값 $2$ 보다 크므로 삭제)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo21.drawio.svg>)

단조 덱 (인덱스 $3$ 의 값 $3$ 이 인덱스 $5$ 의 값 $2$ 보다 크므로 삭제)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo22.drawio.svg>)

단조 덱 (인덱스 $5$ 삽입)

![](</assets/posts/2025-11/덱을%20이용한%20구간%20최대／최소%20트릭%20(Sliding%20Window%20Max／Min)/photo23.drawio.svg>)

이러한 삽입, 삭제, 조회를 반복하면 수열을 한번만 순회하며 각 구간의 최솟값을 모두 구할 수 있다.

---

## Ref

- [IOI KOREA - Deque을 이용한 구간 쿼리](https://youtu.be/eBAbXG4bmvk?si=_q_f4tWO3_Iwi959)

---
