---
title: "[Programmers] 157342번 - 자동차 평균 대여 기간 구하기 [MySQL]"
slug: programmers-157342
date: 2026-01-12
categories: [PS, Programmers]
tags: [SQL]
toc: true
math: true
---

[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/157342)

---

## 1. 문제 풀이

<br>

`DATEDIFF` 함수로 대여 종료일과 대여 시작일의 차를 구할 수 있다. `AVG` 함수와 `ROUND` 함수로 반올림한 평균 대여 기간을 구했고, 이를 `HAVING` 절의 조건으로 활용했다.

---

## 2. 쿼리

<br>

```sql
SELECT CAR_ID, ROUND(AVG(DATEDIFF(END_DATE, START_DATE) + 1), 1) AS AVERAGE_DURATION
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
GROUP BY CAR_ID
HAVING AVERAGE_DURATION >= 7
ORDER BY AVERAGE_DURATION DESC, CAR_ID DESC;
```

---
